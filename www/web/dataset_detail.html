<!--
@author [Wankun Deng]
@email [dengwankun@gmail.com]
@create date 2023-04-27 15:32:46
@modify date 2023-05-31 16:10:45
@desc [description]
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name=""author" content="Wankun Deng">
  
    <title>Dataset view</title>
    <style>
    @import url('css/te_table.css');
    </style>
    <style>
    @import url('css/highcharts.css');
    </style>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
  </head>

<script src="js/third_party/highcharts.js"></script>
<script src="js/third_party/data.js"></script>
<script src="js/third_party/drilldown.js"></script>
<script src="js/third_party/exporting.js"></script>
<script src="js/third_party/export-data.js"></script>
<script src="js/third_party/accessibility.js"></script>
<script type="text/javascript" src="js/third_party/jquery-3.2.1.min.js"></script>
<script src="js/third_party/d3.v7.min.js"> import * as d3 from "d3"</script>
<script src="js/third_party/forceGraph.js"> </script>
<script src="js/third_party/bootstrap.min.js"></script>
<script type="text/javascript" src="js/utils.js"></script>

<body onload='init()' style="background-color:#efefef;">
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" w3-include-html="navigation.html"></nav>

  <div style="width: 60%; min-width: 1100px; margin-block: 100px;" class="container-fluid">
    <div class="row" id="Overview">
      <div class="col mb-3 pl-0 pr-0 mr-3 ml-0" id="Desc_container" >
        <div class="card " >
          <h5 class="card-header">Dataset information</h5>
          <div class="card-body overflow-auto" id="desc" style="height: 500px;">
          </div>
        </div>
      </div>
      <div class="col mb-3 pl-0 pr-0 mr-0 ml-3" id="'cell_count_container">
        <div class="card mb-0">
          <h5 class="card-header">Number of Cells</h5>
          <div class="card-body" id="cell_count" style="height: 500px;">
            <figure class="highcharts-figure">
              <div id="container_cell_count"></div>
              <button id="plain">Plain</button>
              <button id="inverted">Inverted</button>
            </figure>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row" id="umap">
      <div class="card col-md-12 ml-0 mr-0 pl-0 pr-0">
        <h5 class="card-header">Cell Clustering & Gene Expression</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
                <figure class="highcharts-figure">
                  <div id="container_umap" style="min-height: 700px;"></div>
                  <label for="cell_types">Cell type:</label>
                  <select name="Cell types" id="cell_types">
                    <option value=-1 >All</option>
                    <option value= 0 >Excitatory Neuron</option>
                    <option value=1 >Inhibitory Neuron</option>
                    <option value=2 >Oligodendrocyte Progenitor Cell</option>
                    <option value=3 >Oligodendrocyte</option>
                    <option value=4 >Astrocyte</option>
                    <option value=5 >Microglia</option>
                    <option value=6 >Endothelial</option>
                    <option value=6 >VLMC</option>
                  </select>
                </figure>
            </div>
            <div class="col-md-6">
              <figure class="highcharts-figure">
                <div id="container_gene_exp" style="min-height: 700px;"></div>
                <label for="Gene">Gene/TE:</label>
                <select name="Gene" id="Gene">
                  <option value='AluY'>AluY</option>
                  <option value='SYT1'>SYT1</option>
                  <option value='SLC17A7'>SLC17A7</option>
                  <option value='MBP'>MBP</option>
                </select>
              </figure>  
            </div>
          </div>
          </div>
        </div>  
      </div>
    </div>
  </div>

<script type="text/javascript">
    function init(){
        var queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        var cate=urlParams.get('Cate')
        if(cate == null){
          cate='Dataset'
            var href=window.location.href
            if(!queryString.includes('?')){
                href=href+'?Cate='+cate
            }else{
                href=href+'&Cate='+cate
            }
            window.history.pushState({},0,href)
            window.history.replaceState({},0,href)
            urlParams.set('Cate',cate)
        }
        var kw=urlParams.get('KW')
        if(kw == null){
            kw='AD_HS_00001'
            var href=window.location.href
            href=href+'&KW='+kw
            window.history.pushState({},0,href)
            window.history.replaceState({},0,href)
            urlParams.set('KW',kw)
        }
        $.get("/cgi/get_dataset_basic.py",{Cate: urlParams.get('Cate') , KW: urlParams.get('KW')},
            function(response){
                document.getElementById('desc').style.display='block'
                $('#desc').html(response)
                document.title='scARE: '+urlParams.get('KW')
                // document.getElementById()
            }
        );
        var content_only=urlParams.get('CL')
        if(content_only==null || content_only=='' || content_only=='F'){
          includeHTML();
        }
    }
</script>
<script src="js/cell_count/cell_count.js"></script>
<script src="js/umap/umap.js" ></script>
<script src="js/umap/umap_gene.js" ></script>
<div w3-include-html="footer.html"></div>
</body>
</html>