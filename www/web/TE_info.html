<!--
@author [Wankun Deng]
@email [dengwankun@gmail.com]
@create date 2023-04-27 15:33:01
@modify date 2023-05-31 18:20:30
@desc [description]
-->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name=""author" content="Wankun Deng">
<title>TE view</title>
<style>@import url('css/te_table.css');</style>
<style>@import url('css/highcharts.css');</style>
<link href="css/bootstrap.min.css" rel="stylesheet"/>
<link rel="stylesheet" href="css/jquery.dataTables.css" />
<script src='js/third_party/plotly-2.20.0.min.js'></script>
<script src="js/third_party/highcharts.js"></script>
<script src="js/third_party/data.js"></script>
<script src="js/third_party/heatmap.js"></script>
<script src="js/third_party/drilldown.js"></script>
<script src="js/third_party/exporting.js"></script>
<script src="js/third_party/highcharts-more.js"></script>
<script src="js/third_party/export-data.js"></script>
<script src="js/third_party/accessibility.js"></script>
<script src="js/third_party/networkgraph.js"></script>
<script type="text/javascript" src="js/third_party/jquery-3.2.1.min.js"></script>
<script src="js/third_party/d3.v7.min.js"> import * as d3 from "d3"</script>
<script src="js/third_party/forceGraph.js"> </script>
<script src="js/third_party/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script src="js/te_info/chr_dist.js"></script>
<script src="js/third_party/jquery.dataTables.js"></script>

</head>

<body onload='init()' style="background-color:#efefef;">
<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" w3-include-html="navigation.html"></nav>

<div style="width: 60%; min-width: 1100px;margin-block:100px" class="container-fluid">
    <!--first row-->
    <div class="row" id="Overview">
      <!--Basic information-->
      <div class="col mb-3 pl-0 pr-0 mr-3 ml-0" id="desc_container" >
        <div class="card " >
          <h5 class="card-header">TE information</h5>
          <div class="card-body overflow-auto" id="desc" style="height: 500px;">
          </div>
        </div>
      </div>
      <!--TE distribution across chromosome-->
      <div class="col mb-3 pl-0 pr-0 mr-0 ml-3" id="'chr_dist_container">
        <div class="card mb-0">
          <h5 class="card-header">Distribution of Locus</h5>
          <div class="card-body" id="chr_dist" style="height: 500px;">
            <figure class="highcharts-figure">
              <div id="container_chr_dist"></div>
              <button id="plain_chrdist">Plain column</button>
              <button id="inverted_chrdist">Inverted column</button>
              <button id="line_chrdist">Line</button>
              <button id="pie_chrdist">Pie</button>
            </figure>
          </div>
        </div>
      </div>
    </div>
    <!--second row-->
    <div class="row" id="chr_ea_dist">
    <!--TE distribution on each chromosome-->
      <div class="col mb-3 pl-0 pr-0 mr-3 ml-0" id="'chrea_dist_container">
        <div class="card mb-0">
          <h5 class="card-header">Distribution on each chromosome</h5>
          <div class="card-body" id="chrea_dist" style="height: 500px;">
            <figure class="highcharts-figure">
              <div id="container_chrea_dist"></div>
            </figure>
          </div>
        </div>
      </div>
      <!--TE genomic region distribution-->
      <div class="col mb-3 pl-0 pr-0 mr-0 ml-3" id="region_container" >
        <div class="card " >
          <h5 class="card-header">Distribution in genomic regions</h5>
          <div class="card-body overflow-auto" id="region_dist" style="height: 500px;">
            <figure class="highcharts-figure">
              <div id="container_region_dist"></div>
            </figure>
          </div>
        </div>
      </div>
      
    </div>
    <!--third row-->
    <div class="row" id="row3">
      <!-- TE expression boxplot -->
      <div class="col mb-3 pl-0 pr-0 mr-0 ml-0" id="exp_container">
        <div class="card mb-0">
          <h5 class="card-header">TE Expression</h5>
          <div class="card-body"id="exp_body">
          </div>
        </div>
      </div>
    </div>
    <div class="row" id="row4">
      <!-- TE-gene network-->
      <div class="col mb-3 pl-0 pr-0 mr-0 ml-0" id="network_container">
        <div class="card mb-0">
          <h5 class="card-header">TE-Gene network</h5>
          <div class="card-body" id="te_gene">
            <!--<figure class="highcharts-figure">
                <div id="container_network"></div>
                <label for="degree">Network degree:</label>
                <select name="degree" id="degree">
                  <option value='1'>1</option>
                  <option value='2'>2</option>
                </select>
                <label for="showLabel">Show Label:</label>
                <select name="showLabel" id="showLabel">
                  <option value='false' selected>Hide</option>
                  <option value='true' >Show</option>
                </select>
            </figure>-->
          </div>
        </div>
      </div>
    </div>
</div>

<script type="text/javascript">
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    function init(){
        const urlParams = new URLSearchParams(window.location.search);
        var content_only=urlParams.get('CL')
        if(content_only==null || content_only=='T' || content_only=='F'){
          includeHTML();
        }
        if(!('Class' in urlParams)){
          urlParams.set('Class','N/A')
        }
        if(!('Family' in urlParams)){
          urlParams.set('Family','N/A')
        }
        $.get('/cgi/te_info/get_te_overview.py',{Class: urlParams.get('Class') , Family: urlParams.get('Family'), Name: urlParams.get('Name')},
            function(response){
                response=JSON.parse(response)
                document.getElementById('desc').style.display='block'
                $('#desc').html(response[0]);
                showChrDist(response[1]);
                showChrEaDist(response[2]);
                showRegionDist(response[3]);
            }
        );
        sleep(100).then(()=>{$.get('/cgi/te_info/get_te_containing_gene.py',{Class: urlParams.get('Class') , Family: urlParams.get('Family'), Name: urlParams.get('Name')},
            function(response){
                $('#te_gene').html(response);
                let table = new DataTable('#gene_table', {response:true});  
            }
        );});
    }
</script>
<script type="text/javascript" src="js/te_info/te_exp_plotly.js"></script>
<div w3-include-html="footer.html"></div>
</body>
